<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" charset="utf-8">
    <title></title>
    <link href="css/styles.css" rel="stylesheet"/>
    <link href="css/table.css" rel="stylesheet"/>
    <script src="js/jquery.js" type="text/javascript"></script>
    <script src="js/jquery-ui.js" type="text/javascript"></script>
    <script src="js/spin.min.js" type="text/javascript"></script>
    <script src="js/translator.js" type="text/javascript"></script>
    <script src="js/productsFinder.js" type="text/javascript"></script>
    <script src="js/bargainScripts.js" type="text/javascript"></script>
    <script src="lang/words.js" type="text/javascript"></script>


    <script type="text/javascript">
        function setProductInfo() {
            var product = getFromSessionStorage('product');

            var newShopPrice = document.getElementById('finalShopPrice').innerText.trim();
            if (newShopPrice.length == 0) {
                document.getElementById('finalShopPrice').innerText = getFromSessionStorage('originalShopPrice');
            }
            document.getElementById('currencyCodeNewPrice').innerText = getFromSessionStorage('currencyCode');
        }

        function validateSuggestedPrice(minShopPrice, newShopPrice, clientPrice, countOfItemsToGetOneFree) {
            if (clientPrice >= newShopPrice || (clientPrice / minShopPrice) > 1.3) {
                //alert("We are agree with Your Offer! \nSell price is " + clientPrice + " " + currencyCode);
                saveToSessionStorage('priceFinal', clientPrice);
                runSpinnerWithRedirect('spinnerPlace', '005thankYou.html');
            }
            else {
                var newOfferPrice = generateNewShopPrice(minShopPrice, newShopPrice, clientPrice, countOfItemsToGetOneFree);
                document.getElementById('finalShopPrice').innerText = newOfferPrice.toFixed(2);
                document.getElementById('clientPriceTxt').value = "";
                saveToSessionStorage('priceFinal', newOfferPrice);
                //alert("We've just provided Best Offer. \nClick [Buy Now!] to agree or suggest your price!");
            }
        }
    </script>

</head>

<!--///////////////-->
<body onload="saveToSessionStorage('page', '003Bargain.html');
            setProductInfo();
            translate(['btnBuyNow','product_price_offer', 'suggest_new_price',
                       'bargain_header', 'btnHome',
                        'btnSuggestNewPrice', 'finalShopPrice']);">

<div id="page" class="table fullScreen">
    <div class="tableRow headerFontStyle background" style="height: 25%;">
        <div class="tableCell">
            <div class="table" style="width: 100%;">
                <div class="tableRow">
                    <div class="tableCellStepHeader middleCenterContainer">
                        <span id="bargain_header">!</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="tableRow bodyFontStyle" style="height: 60%;">
        <div id="spinnerPlace" class="tableCell">
            <div class="table" style="width: 100%;">
                <div class="tableRow">
                    <div class="tableCell leftPart"
                         style="background-size: 100%; background: url(images/barbain_ex.jpg) no-repeat center ;">
                    </div>
                    <div class="tableCell middleRightContainer">


                        <span class="offerPriceFontStyle" id="product_price_offer"></span>
                        <span class="offerPriceFontStyle" id="finalShopPrice"></span>
                        <span class="offerPriceFontStyle" id="currencyCodeNewPrice"></span>
                        <button type="button" id="btnBuyNow"
                                onclick="saveToSessionStorage('priceFinal', document.getElementById('finalShopPrice').innerText);
                                redirectToPage('004enterClientInfo.html');">
                        </button>
                        <br/> <br/>
                        <input id="clientPriceTxt" type="text" class="inputField"/>
                        <button type="button" id="btnSuggestNewPrice"
                                onclick="validateSuggestedPrice(
                                                                getFromSessionStorage('minShopPrice'),
                                                                parseFloat(document.getElementById('finalShopPrice').innerText),
                                                                parseFloat(document.getElementById('clientPriceTxt').value.trim()),
                                                                getFromSessionStorage('countOfItemsToGetOneFree'))"></button>


                    </div>

                </div>


            </div>
        </div>
    </div>
    <div class="tableRow">
        <div class="tableCell">
            <div class="table" style="width: 100%;">
                <div class="tableRow">
                    <div class="tableCell middleLeftContainer">
                        <button type="button" id="btnHome" style="width: 30%;"
                                onclick="redirectToPage('000home.html');">
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

</body>
</html>
